# 关于页面PDF输出功能

## 功能概述

为关于页面添加了PDF输出功能，用户可以将关于页面的内容下载为PDF格式的文档。

## 功能特性

- ✅ 自动生成PDF文档
- ✅ 保持原有内容的格式和样式
- ✅ 支持中文内容
- ✅ 响应式设计，移动端友好
- ✅ 自动添加页眉页脚
- ✅ 生成时间戳文件名

## 技术实现

### 依赖包
- `reportlab==4.0.9` - PDF生成库
- `Pillow==10.4.0` - 图像处理支持

### 中文字体支持
- 自动注册中文字体（STSong-Light 或 SimSun）
- 支持中文字符的正确显示
- 处理Unicode编码问题
- 标题使用粗体字体（STSong 或 SimSun）
- 正文使用轻量字体（STSong-Light 或 SimSun）

### 核心文件
- `app/utils/pdf_generator.py` - PDF生成工具类
- `app/routes/main.py` - PDF下载路由
- `app/templates/frontend/about.html` - 关于页面模板（添加了PDF下载按钮）

### 主要功能

1. **PDF生成器类** (`PDFGenerator`)
   - 自定义样式设置
   - HTML内容清理和解析
   - PDF文档构建

2. **路由处理** (`/about/pdf`)
   - 获取关于页面内容
   - 生成PDF文件
   - 返回下载响应

3. **前端界面**
   - PDF下载按钮
   - 响应式设计
   - 美观的样式

## 使用方法

1. 访问关于页面 (`/about`)
2. 点击"下载PDF版本"按钮
3. 浏览器会自动下载生成的PDF文件

## 文件命名规则

PDF文件名采用双重命名策略：

1. **英文文件名**：`about_{时间戳}.pdf`（用于HTTP响应头，避免编码问题）
2. **中文显示名**：`{页面标题}_{时间戳}.pdf`（用于浏览器显示）

例如：
- 英文文件名：`about_20250110_143022.pdf`
- 中文显示名：`关于我_20250110_143022.pdf`

使用RFC 5987标准处理中文文件名，确保浏览器正确显示中文文件名。

## 样式特性

- A4纸张大小
- 2cm页边距
- 自定义字体和颜色
- 标题层级样式（加粗显示）
- 正文使用正常粗细字体（不加粗）
- 页眉页脚信息
- 自动分页
- 优化的行间距和段落间距

## 错误处理

- 内容为空时返回404错误
- PDF生成失败时返回500错误
- 详细的日志记录

## 扩展性

该功能设计为可扩展的，可以轻松添加：
- 其他页面的PDF输出
- 自定义PDF模板
- 更多样式选项
- 批量PDF生成

## 注意事项

1. 确保服务器有足够的磁盘空间存储临时文件
2. 大量并发请求可能影响性能
3. 建议定期清理生成的PDF文件
4. 确保所有依赖包正确安装
5. 中文字体支持需要系统安装相应的字体文件
6. 如果遇到编码问题，系统会自动降级到默认字体

## 故障排除

### UnicodeEncodeError 错误
如果遇到 `UnicodeEncodeError: 'latin-1' codec can't encode characters` 错误：

**PDF内容编码问题：**
1. 确保使用最新版本的PDF生成器
2. 检查中文字体是否正确注册
3. 查看日志文件了解详细错误信息

**HTTP响应头编码问题：**
1. 使用RFC 5987标准处理中文文件名
2. 提供英文备选文件名
3. 使用URL编码处理特殊字符

### 中文字体显示问题
如果中文字符显示为方块：
1. 检查系统是否安装了中文字体
2. 尝试手动注册字体文件
3. 使用系统默认字体作为备选方案
