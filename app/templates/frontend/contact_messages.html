{% extends "base.html" %}

{% block title %}我的私信 - 我的个人网站{% endblock %}

{% block content %}
<!-- 页面头部 -->
<div class="text-center py-16 mb-12">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-indigo-400 to-purple-500 bg-clip-text text-transparent">
            我的私信
        </h1>
        <p class="text-xl text-slate-300 mb-8">查看您发送的私信记录和回复</p>
    </div>
</div>

<div class="max-w-6xl mx-auto px-4">
    <!-- 操作按钮 -->
    <div class="flex items-center justify-between mb-8">
        <div class="flex items-center space-x-4">
            <a href="{{ url_for('main.contact') }}" class="btn-secondary">
                <i class="fas fa-plus mr-2"></i> 发送新消息
            </a>
        </div>
        <div class="text-sm text-slate-400">
            共 {{ messages|length }} 条私信
        </div>
    </div>

    <!-- 私信列表 -->
    {% if messages %}
    <div class="space-y-6">
        {% for message in messages %}
        <div class="glass-card rounded-xl p-6 hover:bg-slate-800/30 transition-all duration-300 cursor-pointer"
             onclick="window.location.href='{{ url_for('main.contact_message_detail', message_id=message.id) }}'">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="flex items-center mb-3">
                        <h3 class="text-lg font-semibold text-white mr-3">{{ message.subject }}</h3>
                        <span class="px-2 py-1 text-xs rounded-full
                            {% if message.status == 'unread' %}bg-red-600/20 text-red-400
                            {% elif message.status == 'read' %}bg-blue-600/20 text-blue-400
                            {% elif message.status == 'replied' %}bg-green-600/20 text-green-400
                            {% elif message.status == 'in_conversation' %}bg-purple-600/20 text-purple-400
                            {% else %}bg-slate-600/20 text-slate-400{% endif %}">
                            {% if message.status == 'unread' %}未读
                            {% elif message.status == 'read' %}已读
                            {% elif message.status == 'replied' %}已回复
                            {% elif message.status == 'in_conversation' %}对话中
                            {% else %}已归档{% endif %}
                        </span>
                    </div>
                    
                    <p class="text-slate-300 mb-3 line-clamp-2">{{ message.message[:100] }}{% if message.message|length > 100 %}...{% endif %}</p>
                    
                    <div class="flex items-center text-sm text-slate-400 space-x-4">
                        <span><i class="fas fa-clock mr-1"></i>{{ message.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                        {% if message.replies %}
                        <span><i class="fas fa-comments mr-1"></i>{{ message.replies|length }} 条回复</span>
                        {% endif %}
                        {% if message.replied_at %}
                        <span><i class="fas fa-reply mr-1"></i>最后回复: {{ message.replied_at.strftime('%m-%d %H:%M') }}</span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="ml-4 flex items-center">
                    <i class="fas fa-chevron-right text-slate-400"></i>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <!-- 空状态 -->
    <div class="glass-card rounded-xl p-12 text-center">
        <div class="w-20 h-20 bg-slate-600/50 rounded-full flex items-center justify-center mx-auto mb-6">
            <i class="fas fa-envelope text-slate-400 text-3xl"></i>
        </div>
        <h3 class="text-xl font-semibold text-white mb-3">暂无私信记录</h3>
        <p class="text-slate-400 mb-6">您还没有发送过任何私信</p>
        <a href="{{ url_for('main.contact') }}" class="btn-primary">
            <i class="fas fa-plus mr-2"></i> 发送第一条私信
        </a>
    </div>
    {% endif %}
</div>

<style>
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %}
